# Development Dockerfile с hot reload
FROM node:20-alpine

# Устанавливаем зависимости для сборки native modules
RUN apk add --no-cache python3 make g++ git

# Устанавливаем рабочую директорию
WORKDIR /app

# Копируем package.json и package-lock.json
COPY package*.json ./

# Устанавливаем все зависимости (включая dev)
RUN npm install

# Копируем Prisma схему для генерации
COPY prisma ./prisma/

# Генерируем Prisma Client
RUN npx prisma generate

# Копируем конфигурационные файлы
COPY vite.config.ts tsconfig.json tsconfig.node.json ./
COPY tailwind.config.js postcss.config.js ./
COPY index.html ./

# Открываем порты для Vite и Electron
EXPOSE 5173 5174

# Создаем переменную окружения
ENV NODE_ENV=development
ENV DATABASE_URL="file:./dev.db"

# Команда для запуска в dev режиме
CMD ["npm", "run", "dev:vite"] 